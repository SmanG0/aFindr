{
  "name": "MACDCrossoverStrategy",
  "description": "MACD crossover strategy with histogram confirmation - buy on bullish crossover with positive histogram, sell on bearish crossover or negative histogram",
  "code": "import pandas as pd\nimport numpy as np\nimport ta\nfrom engine.strategy import BaseStrategy, Signal\n\nclass MACDCrossoverStrategy(BaseStrategy):\n    def on_bar(self, bar, history):\n        if len(history) < 35:\n            return None\n        \n        macd_indicator = ta.trend.MACD(history['close'], window_fast=12, window_slow=26, window_sign=9)\n        macd_line = macd_indicator.macd()\n        signal_line = macd_indicator.macd_signal()\n        histogram = macd_indicator.macd_diff()\n        \n        current_macd = macd_line.iloc[-1]\n        current_signal = signal_line.iloc[-1]\n        current_histogram = histogram.iloc[-1]\n        \n        prev_macd = macd_line.iloc[-2]\n        prev_signal = signal_line.iloc[-2]\n        \n        current_price = bar['close']\n        stop_loss = current_price * 0.98\n        take_profit = current_price * 1.04\n        \n        # Buy signal: MACD crosses above signal line and histogram is positive\n        if prev_macd <= prev_signal and current_macd > current_signal and current_histogram > 0:\n            return Signal(action='buy', size=1.0, stop_loss=stop_loss, take_profit=take_profit)\n        \n        # Sell signal: MACD crosses below signal line or histogram turns negative\n        if (prev_macd >= prev_signal and current_macd < current_signal) or current_histogram < 0:\n            return Signal(action='close')\n        \n        return None",
  "parameters": {
    "fast_period": 12,
    "slow_period": 26,
    "signal_period": 9,
    "stop_loss_pct": 0.02,
    "take_profit_pct": 0.04
  },
  "symbol": "NQ=F",
  "interval": "1d",
  "created_at": "2026-02-24T04:37:12.672785",
  "backtest_metrics": {
    "total_trades": 11,
    "win_rate": 0.18181818181818182,
    "loss_rate": 0.8181818181818182,
    "total_return": -26026.6,
    "total_return_pct": -104.11,
    "max_drawdown": -41315.8,
    "max_drawdown_pct": -102.55,
    "max_consecutive_losses": 7,
    "max_consecutive_wins": 1,
    "profit_factor": 0.52,
    "sharpe_ratio": -4.38,
    "avg_win": 14276.2,
    "avg_loss": -6064.33,
    "sortino_ratio": -11.99,
    "calmar_ratio": 23.26,
    "recovery_factor": 0.63,
    "expectancy": -2366.05,
    "expectancy_ratio": -0.39,
    "payoff_ratio": 2.35,
    "deflated_sharpe_ratio": -4.2554,
    "dsr_pvalue": 1.0
  },
  "monte_carlo": {
    "num_simulations": 1000,
    "num_trades": 11,
    "mean_return": -26026.6,
    "median_return": -26026.6,
    "std_return": 0.0,
    "percentile_5": -26026.6,
    "percentile_25": -26026.6,
    "percentile_75": -26026.6,
    "percentile_95": -26026.6,
    "mean_max_drawdown": -38993.9,
    "median_max_drawdown": -38314.35,
    "worst_max_drawdown": -54579.0,
    "percentile_95_drawdown": -54579.0,
    "probability_of_ruin": 100.0,
    "probability_of_profit": 0.0,
    "equity_percentiles": {
      "p5": [
        25000.0,
        14615.7,
        7450.7,
        1045.7,
        -5789.0,
        -10172.5,
        -14759.89,
        -19064.7,
        -19553.66,
        -17329.0,
        -20044.0,
        -1026.6
      ],
      "p25": [
        25000.0,
        17466.8,
        11736.8,
        7070.0,
        2616.8,
        -896.5,
        -460.78,
        -2364.7,
        -4293.52,
        -4831.6,
        -896.6,
        -1026.6
      ],
      "p50": [
        25000.0,
        19270.0,
        15880.0,
        14621.8,
        15258.5,
        13242.05,
        10142.15,
        8030.0,
        9193.4,
        7755.9,
        4703.4,
        -1026.6
      ],
      "p75": [
        25000.0,
        22285.0,
        28805.0,
        27570.78,
        25960.0,
        23627.55,
        23727.7,
        22116.6,
        17020.9,
        12236.6,
        6506.6,
        -1026.6
      ],
      "p95": [
        25000.0,
        44017.4,
        41302.4,
        43179.49,
        41659.2,
        38944.2,
        34593.1,
        29604.2,
        23295.9,
        16663.1,
        9357.7,
        -1026.6
      ]
    },
    "method": "reshuffle",
    "robustness_score": null,
    "robustness_grade": null,
    "sub_results": null
  }
}