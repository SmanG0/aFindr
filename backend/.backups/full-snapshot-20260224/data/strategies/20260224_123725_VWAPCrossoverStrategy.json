{
  "name": "VWAPCrossoverStrategy",
  "description": "Buy when price crosses above VWAP, sell when price crosses below VWAP",
  "code": "import pandas as pd\nimport numpy as np\nimport ta\nfrom engine.strategy import BaseStrategy, Signal\n\nclass VWAPCrossoverStrategy(BaseStrategy):\n    def on_bar(self, bar, history):\n        if len(history) < 2:\n            return None\n        \n        # Calculate VWAP using rolling window\n        typical_price = (history['high'] + history['low'] + history['close']) / 3\n        vwap = (typical_price * history['volume']).cumsum() / history['volume'].cumsum()\n        \n        current_price = bar['close']\n        current_vwap = vwap.iloc[-1]\n        prev_price = history['close'].iloc[-2]\n        prev_vwap = vwap.iloc[-2]\n        \n        # Buy when price crosses above VWAP\n        if prev_price <= prev_vwap and current_price > current_vwap:\n            return Signal(action='buy', size=1.0)\n        \n        # Sell when price crosses below VWAP\n        if prev_price >= prev_vwap and current_price < current_vwap:\n            return Signal(action='sell', size=1.0)\n        \n        return None",
  "parameters": {
    "lookback_period": 20
  },
  "symbol": "NQ=F",
  "interval": "5m",
  "created_at": "2026-02-24T12:37:25.895430",
  "backtest_metrics": {
    "total_trades": 75,
    "win_rate": 0.10666666666666667,
    "loss_rate": 0.8933333333333333,
    "total_return": 135720.0,
    "total_return_pct": 542.88,
    "max_drawdown": -24245.0,
    "max_drawdown_pct": -33.04,
    "max_consecutive_losses": 50,
    "max_consecutive_wins": 4,
    "profit_factor": 5.69,
    "sharpe_ratio": 2.12,
    "avg_win": 20583.12,
    "avg_loss": -432.01,
    "sortino_ratio": 95.39,
    "calmar_ratio": 55.22,
    "recovery_factor": 5.6,
    "expectancy": 1809.6,
    "expectancy_ratio": 4.19,
    "payoff_ratio": 47.64,
    "deflated_sharpe_ratio": 10.1211,
    "dsr_pvalue": 0.0
  },
  "monte_carlo": {
    "num_simulations": 1000,
    "num_trades": 75,
    "mean_return": 135720.0,
    "median_return": 135720.0,
    "std_return": 0.0,
    "percentile_5": 135720.0,
    "percentile_25": 135720.0,
    "percentile_75": 135720.0,
    "percentile_95": 135720.0,
    "mean_max_drawdown": -15043.62,
    "median_max_drawdown": -14550.0,
    "worst_max_drawdown": -27990.0,
    "percentile_95_drawdown": -21948.0,
    "probability_of_ruin": 18.1,
    "probability_of_profit": 100.0,
    "equity_percentiles": {
      "p5": [
        25000.0,
        24040.0,
        23455.0,
        22929.5,
        22509.75,
        21949.5,
        21410.0,
        20969.25,
        20544.0,
        20039.5,
        19639.25,
        19239.5,
        18809.75,
        18379.0,
        18009.25,
        17744.0,
        17294.75,
        16859.5,
        16420.0,
        16099.5,
        15714.75,
        15444.75,
        15114.5,
        14783.25,
        14379.75,
        14067.25,
        13609.25,
        13256.25,
        12864.5,
        12509.5,
        12213.75,
        11892.75,
        11484.5,
        11103.75,
        10951.0,
        10504.75,
        10250.0,
        10369.0,
        9778.5,
        9554.5,
        9193.25,
        8953.5,
        8764.0,
        8540.0,
        8848.25,
        8664.5,
        8794.5,
        21420.25,
        22707.5,
        22286.0,
        22468.75,
        22049.25,
        21588.25,
        21607.25,
        21290.75,
        21369.0,
        21819.0,
        22234.75,
        36260.75,
        36800.75,
        36622.25,
        37074.5,
        51552.5,
        51968.5,
        52067.0,
        51812.75,
        51781.0,
        51714.5,
        51656.0,
        51434.5,
        51414.0,
        106902.25,
        126133.75,
        143169.5,
        160545.0,
        160720.0
      ],
      "p25": [
        25000.0,
        24420.0,
        23970.0,
        23545.0,
        23095.0,
        22702.5,
        22293.75,
        21875.0,
        21532.5,
        21130.0,
        20765.0,
        20365.0,
        19972.5,
        19730.0,
        19391.25,
        19073.75,
        18750.0,
        18465.0,
        18125.0,
        17853.75,
        17521.25,
        17320.0,
        17096.25,
        16942.5,
        16723.75,
        16738.75,
        16875.0,
        30131.25,
        30293.75,
        30577.5,
        30713.75,
        30618.75,
        30490.0,
        30480.0,
        30468.75,
        30263.75,
        30188.75,
        43478.75,
        43977.5,
        44136.25,
        43878.75,
        43833.75,
        43912.5,
        44051.25,
        44186.25,
        44980.0,
        58422.5,
        58860.0,
        58842.5,
        58627.5,
        58595.0,
        58397.5,
        58197.5,
        58180.0,
        58042.5,
        58186.25,
        113007.5,
        114347.5,
        130130.0,
        130556.25,
        130618.75,
        130508.75,
        130270.0,
        130300.0,
        130455.0,
        145383.75,
        146096.25,
        146170.0,
        157523.75,
        161767.5,
        161738.75,
        161580.0,
        161320.0,
        161100.0,
        160860.0,
        160720.0
      ],
      "p50": [
        25000.0,
        24680.0,
        24307.5,
        23905.0,
        23560.0,
        23225.0,
        22875.0,
        22557.5,
        22190.0,
        21925.0,
        21672.5,
        21470.0,
        21260.0,
        21200.0,
        21295.0,
        21420.0,
        35570.0,
        35727.5,
        35705.0,
        35807.5,
        35995.0,
        36367.5,
        49835.0,
        50287.5,
        50512.5,
        50427.5,
        50165.0,
        50270.0,
        50270.0,
        50467.5,
        51400.0,
        65057.5,
        65110.0,
        65437.5,
        65432.5,
        65535.0,
        65860.0,
        67267.5,
        119740.0,
        120350.0,
        120715.0,
        120657.5,
        120980.0,
        121082.5,
        134085.0,
        135430.0,
        135720.0,
        135785.0,
        135605.0,
        135560.0,
        135915.0,
        135800.0,
        135957.5,
        149842.5,
        150187.5,
        150422.5,
        150227.5,
        150027.5,
        150410.0,
        150877.5,
        164640.0,
        164720.0,
        164577.5,
        164455.0,
        164147.5,
        163880.0,
        163710.0,
        163385.0,
        163052.5,
        162750.0,
        162430.0,
        162080.0,
        161752.5,
        161435.0,
        161062.5,
        160720.0
      ],
      "p75": [
        25000.0,
        24870.0,
        24611.25,
        24365.0,
        24100.0,
        23876.25,
        23785.0,
        23930.0,
        39116.25,
        39437.5,
        39623.75,
        55183.75,
        55405.0,
        55605.0,
        55687.5,
        55985.0,
        71955.0,
        72608.75,
        73082.5,
        127223.75,
        127846.25,
        127845.0,
        127678.75,
        127440.0,
        127500.0,
        127516.25,
        127298.75,
        127216.25,
        127261.25,
        127555.0,
        140411.25,
        141622.5,
        141565.0,
        141668.75,
        141636.25,
        141827.5,
        142068.75,
        142352.5,
        155585.0,
        155762.5,
        155996.25,
        156140.0,
        155988.75,
        155880.0,
        155956.25,
        155936.25,
        156191.25,
        169378.75,
        169791.25,
        169602.5,
        169472.5,
        169307.5,
        169151.25,
        168808.75,
        168570.0,
        168287.5,
        168051.25,
        167751.25,
        167437.5,
        167072.5,
        166730.0,
        166358.75,
        165946.25,
        165646.25,
        165301.25,
        164930.0,
        164550.0,
        164205.0,
        163815.0,
        163410.0,
        163035.0,
        162591.25,
        162185.0,
        161750.0,
        161300.0,
        160720.0
      ],
      "p95": [
        25000.0,
        25125.0,
        42480.25,
        59709.25,
        134775.25,
        134364.75,
        134475.75,
        134430.25,
        134220.25,
        133975.25,
        133743.25,
        133532.5,
        133171.75,
        133226.5,
        148283.75,
        148990.5,
        149252.0,
        149568.0,
        163449.0,
        163911.75,
        164020.25,
        163843.25,
        163665.75,
        163543.5,
        163781.5,
        163575.75,
        163585.0,
        163523.5,
        163490.25,
        177166.25,
        177472.75,
        177060.75,
        176907.5,
        176901.5,
        176639.0,
        176530.75,
        176425.0,
        176306.0,
        176151.25,
        175635.0,
        175386.0,
        175127.25,
        174935.25,
        174585.25,
        174120.25,
        173741.25,
        173346.5,
        173000.0,
        172635.25,
        172411.0,
        171906.75,
        171616.25,
        171135.0,
        170850.75,
        170438.5,
        170095.5,
        169621.75,
        169211.25,
        169030.25,
        168531.25,
        168126.0,
        167730.5,
        167270.75,
        166831.25,
        166440.0,
        166008.75,
        165680.0,
        165165.5,
        164735.0,
        164246.25,
        163745.75,
        163310.0,
        162780.0,
        162290.0,
        161575.0,
        160720.0
      ]
    },
    "method": "reshuffle",
    "robustness_score": null,
    "robustness_grade": null,
    "sub_results": null
  }
}