{
  "name": "VWAPCrossoverStrategy",
  "description": "Buy when price crosses above VWAP, sell when price crosses below VWAP with 50 point stop loss",
  "code": "import pandas as pd\nimport numpy as np\nimport ta\nfrom engine.strategy import BaseStrategy, Signal\n\nclass VWAPCrossoverStrategy(BaseStrategy):\n    def on_bar(self, bar, history):\n        if len(history) < 2:\n            return None\n        \n        # Calculate VWAP\n        typical_price = (history['high'] + history['low'] + history['close']) / 3\n        volume_price = typical_price * history['volume']\n        cumulative_volume_price = volume_price.cumsum()\n        cumulative_volume = history['volume'].cumsum()\n        vwap = cumulative_volume_price / cumulative_volume\n        \n        current_price = bar['close']\n        current_vwap = vwap.iloc[-1]\n        prev_price = history['close'].iloc[-2]\n        prev_vwap = vwap.iloc[-2]\n        \n        # Buy when price crosses above VWAP\n        if prev_price <= prev_vwap and current_price > current_vwap:\n            return Signal(action='buy', size=1.0, stop_loss=current_price - 50)\n        \n        # Close when price crosses below VWAP\n        if prev_price >= prev_vwap and current_price < current_vwap:\n            return Signal(action='close')\n        \n        return None",
  "parameters": {
    "stop_loss_points": 50
  },
  "symbol": "NQ=F",
  "interval": "15m",
  "created_at": "2026-02-24T12:37:39.175432",
  "backtest_metrics": {
    "total_trades": 23,
    "win_rate": 0.08695652173913043,
    "loss_rate": 0.9130434782608695,
    "total_return": 96515.0,
    "total_return_pct": 386.06,
    "max_drawdown": -14330.0,
    "max_drawdown_pct": -57.19,
    "max_consecutive_losses": 21,
    "max_consecutive_wins": 1,
    "profit_factor": 7.74,
    "sharpe_ratio": 2.93,
    "avg_win": 55422.5,
    "avg_loss": -682.38,
    "sortino_ratio": 189.62,
    "calmar_ratio": 73.96,
    "recovery_factor": 6.74,
    "expectancy": 4196.3,
    "expectancy_ratio": 6.15,
    "payoff_ratio": 81.22,
    "deflated_sharpe_ratio": 5.9741,
    "dsr_pvalue": 0.0
  },
  "monte_carlo": {
    "num_simulations": 1000,
    "num_trades": 23,
    "mean_return": 96515.0,
    "median_return": 96515.0,
    "std_return": 0.0,
    "percentile_5": 96515.0,
    "percentile_25": 96515.0,
    "percentile_75": 96515.0,
    "percentile_95": 96515.0,
    "mean_max_drawdown": -10852.4,
    "median_max_drawdown": -10760.0,
    "worst_max_drawdown": -14330.0,
    "percentile_95_drawdown": -14275.0,
    "probability_of_ruin": 13.5,
    "probability_of_profit": 100.0,
    "equity_percentiles": {
      "p5": [
        25000.0,
        23995.0,
        22990.0,
        21985.0,
        21485.0,
        20530.0,
        20000.0,
        19244.25,
        18539.5,
        17984.75,
        17310.0,
        16690.0,
        16119.0,
        15539.75,
        15014.5,
        14310.0,
        13804.5,
        13299.75,
        12845.0,
        12345.0,
        11960.0,
        11730.0,
        121460.0,
        121515.0
      ],
      "p25": [
        25000.0,
        23995.0,
        23495.0,
        22665.0,
        22040.0,
        21365.0,
        20810.0,
        20195.0,
        19648.75,
        19070.0,
        18425.0,
        17900.0,
        17383.75,
        16881.25,
        16228.75,
        15765.0,
        15405.0,
        15245.0,
        123528.75,
        123175.0,
        122850.0,
        122305.0,
        121745.0,
        121515.0
      ],
      "p50": [
        25000.0,
        24500.0,
        23765.0,
        23200.0,
        22550.0,
        22042.5,
        21547.5,
        21047.5,
        20607.5,
        20205.0,
        19852.5,
        19675.0,
        127312.5,
        127110.0,
        126662.5,
        126142.5,
        125635.0,
        125132.5,
        124490.0,
        124010.0,
        123470.0,
        122815.0,
        122015.0,
        121515.0
      ],
      "p75": [
        25000.0,
        24770.0,
        24225.0,
        23665.0,
        23275.0,
        22946.25,
        131270.0,
        131252.5,
        130812.5,
        130390.0,
        129891.25,
        129352.5,
        128826.25,
        128265.0,
        127646.25,
        127011.25,
        126475.0,
        125925.0,
        125185.0,
        124690.0,
        123850.0,
        123525.0,
        122520.0,
        121515.0
      ],
      "p95": [
        25000.0,
        25055.0,
        134785.0,
        134558.0,
        134135.0,
        133665.0,
        133215.0,
        132706.0,
        132170.25,
        131660.75,
        131067.5,
        130495.0,
        129895.0,
        129305.5,
        128720.25,
        128100.0,
        127360.25,
        126710.0,
        126020.0,
        125030.0,
        124530.0,
        123525.0,
        122520.0,
        121515.0
      ]
    },
    "method": "reshuffle",
    "robustness_score": null,
    "robustness_grade": null,
    "sub_results": null
  }
}